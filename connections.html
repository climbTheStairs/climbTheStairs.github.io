<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" href="file:///D:/Users/jinha/OneDrive/Desktop/all/default.css">
<style>
label {
  display: block;
}
#result {
  display: flex;
}
#result div {
  flex: 1;
}
#result ul {
  margin-bottom: 15px;
}
</style>
</head>
<body>
<h1>Compare Instagram connections</h1>
<section id="upload">
  <label>
    Upload old JSON:
    <input type="file" id="old" accept=".json" style="width: 80%;">
  </label>
  <label>
    Upload new JSON:
    <input type="file" id="new" accept=".json" style="width: 80%;">
  </label>
  <button>Compare</button>
</section>
<hr>
<section id="result">
  <div>
    Users who unfollowed you:
    <ul id="unfollowers"></ul>
    Users who followed you:
    <ul id="followers"></ul>
  </div>
  <div>
    Users whom you unfollowed:
    <ul id="unfollowing"></ul>
    Users whom you followed:
    <ul id="following"></ul>
  </div>
</section>
<script>
const D = document;
const $ = D.querySelector.bind(D);
const $$ = D.querySelectorAll.bind(D);
const fileReader = new FileReader();
const files = {};
const readFile = function() {
  const id = this.id;
  if (!this.files.length) {
    files[id] = null;
    return;
  }
  fileReader.onload = function(e) {
    files[id] = JSON.parse(this.result);
  };
  fileReader.readAsText(this.files[0]);
};
$$("input").forEach(x => x.addEventListener("change", readFile));
const ig = {};
$("button").onclick = () => {
  // Don't run
  if (!files.old || !files.new) {
    alert("Connections file(s) missing!");
    return;
  }
  // Get changes
  const oldFollowers = Object.keys(files.old.followers);
  const newFollowers = Object.keys(files.new.followers);
  const oldFollowing = Object.keys(files.old.following);
  const newFollowing = Object.keys(files.new.following);
  ig.unfollowers = oldFollowers.filter(u => !newFollowers.includes(u));
  ig.followers   = newFollowers.filter(u => !oldFollowers.includes(u));
  ig.unfollowing = oldFollowing.filter(u => !newFollowing.includes(u));
  ig.following   = newFollowing.filter(u => !oldFollowing.includes(u));
  // Write data
  Object.keys(ig).forEach(key => {
    const users = ig[key].map(u => `<li><a href="http://instagram.com/${u}">${u}</a></li>`);
    $("#" + key).innerHTML = users.join("");
  });
};
</script>
</body>
</html>